<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <title>Twiddler</title>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');

        var $name = $('<h1 class="name">Kiwi</h1>');
        $name.appendTo($body);

        var $username = $('<h2 class="username">@KiwiTheWeenie</h1>');
        $username.appendTo($body);

        var $refreshButton = $('<button id="new-tweets">New Tweets</button>');
        $refreshButton.appendTo($body);

        var $backButton = $('<button id="back-button">Back To Feed</button>');
        $backButton.appendTo($body).hide();

        var $tweetsDiv = $(`<div class="tweetsDiv"></div>`)
        $tweetsDiv.appendTo($body);

        //fetch first tweets
        console.log(`streams.home.length: ${streams.home.length}`)
        //function fetchTweets() {
          var index = 0;
          while(index <= streams.home.length - 1){
            var tweet = streams.home[index];
            var $tweet = $(`<div class="tweet" id="${tweet.user}"></div>`);
            $tweet.text(`@${tweet.user}: ${tweet.message} ${tweet.created_at}`);
            $tweet.prependTo($tweetsDiv);
            index += 1;
          };
        //}

        //functionality for refresh button
        $refreshButton.on("click", function(){
          var numOfTweets = $(".tweet").length;
          var index = numOfTweets;
          while(index <= streams.home.length - 1){
            var tweet = streams.home[index];
            var $tweet = $(`<div class="tweet" id="${tweet.user}"></div>`);
            $tweet.text(`@${tweet.user}: ${tweet.message} ${tweet.created_at}`);
            $tweet.prependTo($tweetsDiv);
            index += 1;
          }
        });

        //functionality for clicking on a user's tweet
        $(document).on("click", ".tweet", function(e){
          $refreshButton.hide();
          $('.tweet').not(`#${e.target.id}`).hide();
          $backButton.show();
        });

        //functionality for back button
        $backButton.on("click", function(){
          $('.tweet').show();
          $refreshButton.show();
          $backButton.hide();
        })
      });

    </script>
  </body>
</html>
